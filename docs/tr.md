# Техническое решение проекта «LeetBook»

## 1. Введение

«LeetBook» — это учебный проект, реализующий прототип распределённой системы для обучения программированию. Система позволяет изучать аспекты языка программирования и закреплять приобретенные знания посредством решения практических задач. Так же пользователь может тренировать навык решения алгоритмических задач. Платформа автоматически проверяет решения, оценивает их корректность, время выполнения и использование памяти. Проект демонстрирует ключевые принципы построения отказоустойчивых и масштабируемых распределённых приложений.
- **Цель проекта:** реализовать прототип распределённой системы, позволяющей эффективно изучать Python, сочетая теорию и практику. 
- **Задачи:** закрепить теоретические основы распределённых систем (масштабируемость, отказоустойчивость, консистентность) через практическую реализацию.  
- **Основания для разработки:** учебный проект в рамках курса «Основы распределённых вычислений».  
- **Команда:**  <br>Шаймиев Камиль | Team Lead , Backend - разработчик, Frontend - разработчик <br>
                Маслов Максим | Backend - разработчик, Frontend - разработчик 

---

## 2. Глоссарий
| Термин        | Определение |
|---------------|-------------|
| Пользователь  | Зарегистрированный клиент системы. |
| Задача        | Практическое задание для закрепления теории. |
| Алгоритмическая задача      | Задача без привязки к конкретному топику, нацеленная на развитие алгоритмического мышления. |
| Код решения       | Код, отправленный пользователем для проверки. |
| Тестирование    | Автоматическая проверка корректности, времени и памяти, потребляемых во время исполнения кода решения. |
| API Gateway   | Точка входа для всех клиентских запросов. |
| Реплика       | Копия данных, поддерживаемая для отказоустойчивости. |
| Консистентность | Свойство, гарантирующее согласованность состояния данных между репликами. |

---

## 3. Функциональные требования
Система должна предоставлять следующие функции:
1. Изучение теоретических материалов по Python.
2. Выполнение практических задач, прикреплённых к топикам.
3. Решение алгоритмических задач (не привязанных к темам).
4. Автоматическая проверка решений с возвратом результата.  

### Ограничения на предметную область

1. Проверка решений ограничивается поддержкой Python 3.x.
2. Пользователь не может изменять условия задач и тесты.

---

## 4. Нефункциональные требования
- **Доступность:** 99.9%.  
- **Масштабируемость:** возможность увеличения числа узлов без модификации логики.  
- **Время отклика:** ≤ 200 мс в условиях локальной сети.  
- **Отказоустойчивость:** система должна продолжать работать при сбое одного из узлов.  
- **Консистентность:** прогресс пользователя будет виден ему самому сразу после вывода результата пользователю (успех, ошибка компиляции, превышение лимитов), в то же время другие пользователи могут какое-то время видеть о нем старые данные. 

---

## 5. Пользовательские сценарии

### Сценарий: изучение теории и решение задачи

1. Пользователь открывает топик «Списки в Python».
2. Пользователь изучает материал и получает задачу, связанную с темой.
3. Пользователь пишет решение и отправляет его на проверку.
4. Выполняется тестирование.
5. Пользователь видит результат (успех или ошибки).

### Сценарий: решение алгоритмической задачи
1. Пользователь выбирает задачу из общего списка.  
2. Пользователь пишет решение и отправляет его.  
3. Выполняется тестирование.
4. Пользователь видит результат (успех или ошибки).  

### Сценарий: просмотр истории переводов
1. Пользователь открывает свой профиль.
2. Система отображает историю отправленных решений с их статусами (успех, ошибка компиляции, превышение лимитов).

## 6. Архитектура

Система состоит из следующих компонентов:

| Компонент | Назначение |
|------------|-------------|
| **API Gateway** | Центральная точка входа для всех клиентских запросов. Выполняет маршрутизацию, валидацию данных и аутентификацию через `User Service`. |
| **User Service** | Управляет пользователями: регистрация, авторизация (JWT), хранение ролей и профилей. |
| **Course Service** | Отвечает за хранение и выдачу учебных курсов, теоретических материалов и пула алгоритмических задач. |
| **Judge Service** | Принимает решения пользователей на проверку, выполняет их в изолированной среде, анализирует результаты (успех, ошибка, превышение лимита) и возвращает отчёт. |
| **PostgreSQL** | Центральная система управления данными. Для изоляции данных каждая служба использует собственную схему (`user_db`, `course_db`, `judge_db`). |



## 7. Технические сценарии

### Сценарий: изучение теории и выполнение задачи

1. Пользователь в клиентском приложении выбирает теоретический модуль (например, «Списки в Python»).  
2. Клиентское приложение отправляет запрос на получение данных о модуле в `API Gateway`.  
3. `API Gateway` перенаправляет запрос в `Course Service`.  
4. `Course Service` обращается к своей базе данных (`course_db`) и возвращает описание теоретического материала и список связанных задач.  
5. Пользователь изучает материал и выбирает задачу для выполнения.  
6. При отправке решения клиент делает запрос POST `/solutions` через `API Gateway`.  
7. `API Gateway` направляет запрос в `Course Service`.  
8. `Course Service` сохраняет решение с меткой `pending` и передаёт код в `Judge Service` на проверку.  
9. `Judge Service` выполняет код в изолированной среде, анализирует результаты тестов и возвращает отчёт (успех, ошибка, превышение лимита и т.д.).  
10. `Course Service` обновляет статус решения и сохраняет результат в своей базе данных.  
11. Пользователь получает результат через повторный запрос GET `/solutions/{id}`.

### Сценарий: решение алгоритмической задачи

1. Пользователь в клиентском приложении выбирает раздел «Алгоритмические задачи».  
2. Клиент отправляет запрос GET `/tasks/free` через `API Gateway`.  
3. `API Gateway` перенаправляет запрос в `Course Service`.  
4. `Course Service` обращается к базе данных `course_db` и получает список задач, где `is_free = true`.  
5. Клиент получает список доступных задач и выбирает одну из них.  
6. Пользователь пишет решение и отправляет его в систему с помощью POST `/solutions` через `API Gateway`.  
7. `API Gateway` передаёт запрос в `Course Service`.  
8. `Course Service` сохраняет решение в базе данных со статусом `pending` и отправляет код задачи в `Judge Service`.  
9. `Judge Service` выполняет код в изолированной среде, сравнивает результаты с эталонными тестами и формирует отчёт.  
10. `Judge Service` возвращает результат проверки в `Course Service`.  
11. `Course Service` обновляет статус решения (успех, ошибка, превышение лимитов) и сохраняет результат в базе данных.  
12. Пользователь запрашивает статус решения через GET `/solutions/{id}` и получает результат.

## 8. План разработки и тестирования

### 8.1 Основной проект (MVP)
**Включает:**
1. Минимальный набор теоретических модулей
2. Набор задач по каждому из модулей
3. Минимальный набор алгоритмических задач

**План разработки:**



**План тестирования:**


**Definition of Done (DoD) для MVP:**
- Полностью реализованы сценарии: решение алгоритмической задачи и просмотр истории решений.
- Реализована доступность (99.9%), масштабируемость, приемлемое время отклика (<=500мс), отказоустойчивость и консистентность, соответствующая нефункциональным требованиям.


### 8.2 Расширенный проект (Advanced Scope)
**Включает:**
- Поддержка системы разнопланового взаимодействия между пользователями
- Анализ успеваемости отедельного пользователя с целью улучшения системы взаимодействия

**План разработки:**


**План тестирования:**
- Тесты на отказоустойчивость (имитация сбоев)
- Тесты масштабируемости (нагрузочное тестирование)

**Definition of Done (DoD) для расширенного проекта:**
- Реализованы сценарии: анализ успеваемости отедельного пользователя с целью улучшения системы взаимодействия и система разнопланового взаимодействия между пользователями.
- Реализована доступность (99.999%), масштабируемость, маленькое время отклика (<=200мс), отказоустойчивость и консистентность, соответствующая нефункциональным требованиям.
